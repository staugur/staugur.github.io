(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{315:function(t,s,a){"use strict";a.r(s);var p=a(0),r=Object(p.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p"),a("p",[a("span",{staticStyle:{color:"inherit","font-family":"inherit","font-size":"36px"}},[t._v("Passport")]),a("br")]),a("blockquote",[a("p",[t._v("请注意：此程序已经过重构，依赖此程序的其他程序若出现认证异常，烦请联系我修改，邮箱staugur@saintic.com。")])]),a("p",[a("b",[t._v("程序描述：")]),t._v("Unified authentication and authorization management SSO system for SaintIC Web  Applications.")]),a("p",[a("b",[t._v("代码仓库：")]),a("a",{attrs:{href:"https://github.com/staugur/passport",target:"_blank"}},[t._v("https://github.com/staugur/passport")])]),a("blockquote",[a("p",[a("b",[a("font",{attrs:{size:"3"}},[t._v("详细文档："),a("a",{attrs:{href:"http://docs.saintic.com/passport/install.html",target:"_blank"}},[t._v("http://docs.saintic.com/passport/install.html")])])],1)])]),a("p",[a("i",[t._v("以下是简略型文档：")])]),a("h4",[a("b",{staticStyle:{"background-color":"rgb(0, 128, 0)"}},[t._v("1. 下载安装")])]),a("pre",{staticStyle:{"max-width":"100%"}},[a("code",{staticClass:"bash hljs",attrs:{codemark:"1"}},[t._v("1.0 yum install -y gcc gcc-c++ python-devel libffi-devel openssl-devel mysql-devel\n"),a("span",{staticClass:"hljs-comment"},[t._v("#开发版本体验")]),t._v("\n1.1 git "),a("span",{staticClass:"hljs-built_in"},[t._v("clone")]),t._v(" https://github.com/staugur/passport &&\\\n    "),a("span",{staticClass:"hljs-built_in"},[t._v("cd")]),t._v(" passport\n"),a("span",{staticClass:"hljs-comment"},[t._v("#稳定版本体验")]),t._v("\n1.1 wget -c -O passport-1.0.3.tar.gz https://codeload.github.com/staugur/passport/tar.gz/v1.0.3 &&\\\n    tar zxf passport-1.0.3.tar.gz &&\\\n    "),a("span",{staticClass:"hljs-built_in"},[t._v("cd")]),t._v(" passport-1.0.3/\n"),a("span",{staticClass:"hljs-comment"},[t._v("#")]),t._v("\n1.2 pip install -r requirements.txt")])]),a("p",[t._v("如果git没有安装，那么执行yum -y install git")]),a("p",[t._v("如果pip没有安装，那么执行yum -y install python-pip(没有python-pip，可先yum -y install epel-release)")]),a("p",[a("br")]),a("h4",[a("b",{staticStyle:{"background-color":"rgb(0, 255, 255)"}},[t._v("2.程序准备")])]),a("p",[a("i",[t._v("2.1 修改配置文件config.py(必要选项)")])]),a("p",[t._v("2.2 创建库，要求utf8,utf8_unicode_ci")]),a("p",[a("i",[t._v("2.3 写入数据库")])]),a("p",[t._v("使用工具或command line导入misc/passport.sql文件")]),a("p",[a("br")]),a("h4",[a("span",{staticStyle:{"background-color":"rgb(255, 0, 0)"}},[t._v("3. 运行使用")])]),a("p",[a("i",[t._v("3.1 sh online_gunicorn.sh start|stop|restart|status")])]),a("h1",{attrs:{id:"h1-license"}},[a("a",{staticClass:"referen\nce-link",attrs:{name:"LICENSE"}})]),a("p",[a("i",[t._v("3.2 supervisord")])]),a("pre",{staticStyle:{"max-width":"100%"}},[a("code",{staticClass:"ini hljs",attrs:{codemark:"1"}},[a("span",{staticClass:"hljs-section"},[t._v("[program:passport]")]),t._v("\n"),a("span",{staticClass:"hljs-attr\n"},[t._v("command")]),t._v("="),a("span",{staticStyle:{"font-size":"inherit"}},[t._v("gunicorn -w $cpu_count --threads 16 -b ${host}:${port} main:app -k gevent --log-file $logfile --max-requests 250 --name $procname #变量自行修改，未测试")]),t._v("\ndirectory=程序src目录\n"),a("span",{staticClass:"hljs-attr"},[t._v("autostart")]),t._v("="),a("span",{staticClass:"hljs-literal"},[t._v("true")]),t._v("\n"),a("span",{staticClass:"hljs-attr"},[t._v("autorestart")]),t._v("="),a("span",{staticClass:"h\nljs-literal"},[t._v("true")]),t._v("\n"),a("span",{staticClass:"hljs-attr"},[t._v("startsecs")]),t._v("="),a("span",{staticClass:"hljs-number"},[t._v("5")]),t._v("\n"),a("span",{staticClass:"hljs-attr"},[t._v("priority")]),t._v("="),a("span",{staticClass:"hljs-number"},[t._v("1")]),t._v("\n"),a("span",{staticClass:"hljs-attr"},[t._v("stopasgroup")]),t._v("="),a("span",{staticClass:"hljs-literal"},[t._v("true")]),t._v("\n"),a("span",{staticClass:"hljs-attr"},[t._v("killasgroup")]),t._v("="),a("span",{staticClass:"hljs-literal"},[t._v("true")])])]),t._v(" "),a("p",[a("i",[t._v("3.3 docker(")]),t._v("参考详细文档"),a("i",[t._v(")")])]),a("p",[a("i",[t._v("3.4 开发启用")])]),a("p",[a("i",[t._v("    python main.py")])]),a("p",[a("i",[a("b",[t._v("3.5 建立管理员账号(！！！)")])])]),a("p",[a("i",[t._v("    3.5.1 执行命令 "),a("code",[t._v("python cli.py --createSuperuser")]),t._v(" 根据提示可以创建管理员用户。")])]),a("p",[a("i",[a("br")])]),a("h4",[a("span",{staticStyle:{"background-color":"rgb(0, 0, 128)"}},[a("font",{attrs:{color:"#ffffff"}},[t._v("4. 客户端")])],1)]),a("blockquote",[a("p",[t._v("目前基于passport认证的项目有："),a("a",{attrs:{href:"https://github.com/staugur/EauDouce",target:"_blank"}},[t._v("EauDouce")]),t._v(", "),a("a",{attrs:{href:"https://github.com/staugur/CherryWaterfall",target:"_blank"}},[t._v("CherryWaterfall")]),t._v(", "),a("a",{attrs:{href:"https://github.com/staugur/IncetOps",target:"_blank"}},[t._v("IncetOps")])]),a("p",[t._v("上述项目中，EauDouce(本站，"),a("a",{attrs:{href:"https://blog.saintic.com",target:"_blank"}},[a("span",[t._v("blog.")]),a("span",[t._v("saintic.com")])]),t._v(")、IncetOps("),a("a",{attrs:{target:"_blank",href:"http://incetops.demo.saintic.com/"}},[t._v("incetops.demo.saintic.com")]),t._v(")为作者官方网站，可以使用https://passport.saintic.com提供的服务，其他情况需要您单独部署passport项目。")])]),a("p",[t._v("    passport代码里有一个demo目录，是一个演示用的客户端程序，关于使用方法说明如下，其他客户端程序类似：")]),a("p",[t._v("    1. 修改配置文件config.py")]),a("p",[t._v("        "),a("b",[t._v("1.1 主要是SSO段的配置，它的信息来自于passport应用管理中")]),t._v("(请参考本文1、2、3步骤部署，假设部署完成，域名是http://passport.demo.com)。")]),a("p",[t._v("        登录passport.demo.com，管理员方能看见应用管理导航，点击进入，可以看到右侧有应用列表和新建应用两个标签页，点击新建应用，如图：")]),a("p",[t._v("        "),a("img",{staticStyle:{"max-width":"100%"},attrs:{src:"https://static.saintic.com/EauDouce/blog/201808091029114480.png",alt:"1"}})]),a("p",[t._v("        "),a("u",[t._v("如图，新建应用所需参数解释如下：")])]),a("p",[t._v("            名称：对应了客户端程序config.py中GLOBAL段ProcessName值(此为默认)，也可以自定义(需修改客户端config.py中SSO段app_name)；")]),a("p",[t._v("            描述：无实际意义，只是描述此应用作业；")]),a("p",[t._v("            回调域名：对应了客户端程序运行的地址，需要完全合格域名，比如http://eaudouce.demo.com，也可以是IP:PORT形式的，请注意域名需要连通的(DNS有解析或hosts有绑定)！")]),a("p",[t._v("        "),a("u",[t._v("点击提交即可，注意上述信息都是客户端的，提交后在应用列表查看应用详情，客户端SSO配置段主要需要以下项：")])]),a("p",[t._v("            应用名：客户端程序config.py中SSO段的app_name，SSO中注册的应用名称；")]),a("p",[t._v("            app_id：客户端程序config.py中SSO段的app_id；")]),a("p",[t._v("            app_secret：客户端程序config.py中SSO段的app_secret；")]),a("p",[t._v("            此外客户端config.py中SSO段中还有一个sso_server，即passport的完全合格域名，即假设的http://passport.demo.com。")]),a("p",[t._v("        1.2 MYSQL、REDIS，看客户端程序需要")]),a("p",[t._v("        "),a("b",[t._v("1.3 SYSTEM段，主要是HMAC_SHA256_KEY、AES_CBC_KEY、JWT_SECRET_KEY，要求值与passport中一致。")])]),a("p",[t._v("    2. 运行测试使用")]),a("p",[t._v("        python main.py")]),a("p",[a("br")]),a("p"),a("p",[a("br")]),t._v(" "),a("Ads")],1)}),[],!1,null,null,null);s.default=r.exports}}]);
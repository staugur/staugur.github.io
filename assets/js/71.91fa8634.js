(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{553:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"h2-u8BF4u660E"}},[s("a",{staticClass:"reference-link",attrs:{name:"说明"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("说明")]),s("p",[t._v("这是一款适用于Layui的[微改整合]第三方组件，基于"),s("a",{attrs:{href:"https://github.com/fengyuanchen/cropper"}},[t._v("cropper 3.1.3")]),t._v("，实现点击一个按钮弹出裁剪框，完成选择、裁剪图片等操作，移动端自适应。")]),t._v(" "),s("p",[t._v("Fly社区组件平台已经有一个"),s("a",{attrs:{href:"https://fly.layui.com/extend/croppers/"}},[t._v("cropper 图片截取（剪裁）上传组件")]),t._v("，可惜我测试中有点问题并不如意，所以就把之前用的"),s("a",{attrs:{href:"http://www.jq22.com/jquery-info18167"}},[t._v("jquery插件")]),t._v("改成layui组件，两者很相像，毕竟都是基于cropper.js(一个3.0.0，一个3.1.3)。")]),s("p",[t._v("代码仓库："),s("a",{attrs:{href:"https://github.com/staugur/layui-cropper-avatar",target:"_blank"}},[t._v("staugur/layui-cropper-avatar")])]),t._v(" "),s("h2",{attrs:{id:"h2-u4F7Fu7528"}},[s("a",{staticClass:"reference-link",attrs:{name:"使用"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("使用")]),s("h3",{attrs:{id:"h3-no-1"}},[s("a",{staticClass:"reference-link",attrs:{name:"NO.1"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("NO.1")]),s("p",[t._v("使用"),s("code",[t._v("git clone")]),t._v("、"),s("code",[t._v("svn checkout")]),t._v("或直接下载压缩包等方式获取仓库代码，将static中的css和mod的js模块复制到你的项目相关目录。")]),t._v(" "),s("p",[t._v("代码目录结构：")]),t._v(" "),s("pre",[s("code",[t._v("├── index.html\n└── static\n    ├── css\n    │   ├── ImgCropping.css //avatar裁剪框样式\n    │   └── cropper.min.css //cropper样式\n    └── mod\n        ├── avatar.js    //依赖cropper模块\n        └── cropper.js   //cropper封装的layui模块\n")])]),s("h3",{attrs:{id:"h3-no-2"}},[s("a",{staticClass:"reference-link",attrs:{name:"NO.2"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("NO.2")]),s("p",[t._v("在HTML的head中引入ImgCropping.css和cropper.min.css")]),t._v(" "),s("h3",{attrs:{id:"h3-no-3"}},[s("a",{staticClass:"reference-link",attrs:{name:"NO.3"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("NO.3")]),s("p",[t._v("在HTML的script中调用模块(请先阅读"),s("a",{attrs:{href:"https://www.layui.com/doc/"}},[t._v("Layui文档")]),t._v("对其模块化有一定了解)：")]),t._v(" "),s("pre",[s("code",[t._v("layui.config({\n    base: '/static/mod/' //mod所在目录\n}).use('avatar', function () {\n    var avatar = layui.avatar;\n    avatar.render({\n        success: function (base64, size) {\n            console.log(base64);\n            console.log(size);\n            //ajax upload\n        }\n    });\n});\n")])]),s("hr"),t._v(" "),s("p",[t._v("avatar模块定义了两个函数：render、base64ToBlob")]),t._v(" "),s("p",[t._v("请用render初始化，base64ToBlob用来把base64图片转为二进制，基本是用不到。")]),t._v(" "),s("p",[t._v("render函数接收object对象完成一些参数设置：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("elem {string}")]),t._v(" "),s("p",[t._v("绑定一个元素，点击它则弹出图片裁剪框，默认是 "),s("strong",[t._v("#uploadAvatar")]),t._v(" ，所以可以放置一个按钮，设置id=uploadAvatar。")])]),s("li",[s("p",[t._v("imgWidth {Number}")]),t._v(" "),s("p",[t._v("裁剪图片的宽度（像素）")])]),s("li",[s("p",[t._v("success {Function}")]),t._v(" "),s("p",[t._v("用户点击 "),s("strong",[t._v("确认裁剪并上传头像")]),t._v(" 按钮的回调，但注意avatar本身不上传，所以需要在success中上传。")]),t._v(" "),s("p",[t._v("success传递两个参数：裁剪后的图片的base64(image/png)、base64的大小（单位Kb）")])])]),t._v(" "),s("h2",{attrs:{id:"h2-u793Au4F8B"}},[s("a",{staticClass:"reference-link",attrs:{name:"示例"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("示例")]),s("p",[t._v("index.html是示例，不能直接运行它，用nginx或者python启动一个web服务：")]),t._v(" "),s("pre",[s("code",[t._v("python2 -m SimpleHTTPServer 5000\n")])]),s("p",[t._v("访问"),s("code",[t._v("127.0.0.1:5000")]),t._v("效果大概是这样的：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.saintic.com/picbed/staugur/2020/05/24/1590253806414.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"h3-ps"}},[s("a",{staticClass:"reference-link",attrs:{name:"ps"}}),s("span",{staticClass:"header-link octicon octicon-link"}),t._v("ps")]),s("ul",[s("li",[s("p",[t._v("如果你要更新cropper.js版本，在上面找到其仓库，下载dist中cropper.js(UMD)，参考Layui第三方组件规范改造UMD（$固定为layui.jquery即可）")])]),s("li",[s("p",[t._v("在线Demo："),s("a",{attrs:{href:"http://picbed.demo.saintic.com/login?next=/control/myself"}},[t._v("picbed图床测试站的个人资料示例")])])])]),t._v(" "),s("p",[s("br")])])}),[],!1,null,null,null);a.default=n.exports}}]);